#!/usr/bin/env python3

import pytest
from cvehound.exception import UnsupportedVersion

@pytest.mark.nometadata(
    ('cve'),
    [
        'CVE-2003-1604',
        'CVE-2004-0230',
        'CVE-2005-3660',
        'CVE-2006-3635',
        'CVE-2006-5331',
        'CVE-2006-6128',
        'CVE-2007-3719',
        'CVE-2007-4774',
        'CVE-2007-6761',
        'CVE-2007-6762',
        'CVE-2008-2544',
        'CVE-2008-4609',
        'CVE-2008-7316',
        'CVE-2009-2692',
        'CVE-2010-0008',
        'CVE-2010-3432',
        'CVE-2010-4563',
        'CVE-2010-4648',
        'CVE-2010-5313',
        'CVE-2010-5321',
        'CVE-2010-5328',
        'CVE-2010-5329',
        'CVE-2010-5331',
        'CVE-2010-5332',
        'CVE-2011-4098',
        'CVE-2011-4915',
        'CVE-2011-4917',
        'CVE-2011-5321',
        'CVE-2011-5327',
        'CVE-2012-2744',
        'CVE-2012-3375',
        'CVE-2012-3510',
        'CVE-2012-3552',
        'CVE-2012-4444',
        'CVE-2012-4467',
        'CVE-2012-4542',
        'CVE-2012-6543',
        'CVE-2012-6689',
        'CVE-2012-6703',
        'CVE-2013-0290',
        'CVE-2013-1763',
        'CVE-2013-1828',
        'CVE-2013-1858',
        'CVE-2013-1935',
        'CVE-2013-1943',
        'CVE-2013-1957',
        'CVE-2013-1958',
        'CVE-2013-1959',
        'CVE-2013-2015',
        'CVE-2013-2017',
        'CVE-2013-2058',
        'CVE-2013-2128',
        'CVE-2013-2636',
        'CVE-2013-2890',
        'CVE-2013-2891',
        'CVE-2013-2894',
        'CVE-2013-2897',
        'CVE-2013-2898',
        'CVE-2013-3226',
        'CVE-2013-3230',
        'CVE-2013-3233',
        'CVE-2013-3236',
        'CVE-2013-3237',
        'CVE-2013-3302',
        'CVE-2013-4125',
        'CVE-2013-4127',
        'CVE-2013-4163',
        'CVE-2013-4205',
        'CVE-2013-4220',
        'CVE-2013-4247',
        'CVE-2013-4270',
        'CVE-2013-4300',
        'CVE-2013-4343',
        'CVE-2013-4588',
        'CVE-2013-4591',
        'CVE-2013-5634',
        'CVE-2013-6431',
        'CVE-2013-6885',
        'CVE-2013-7445',
        'CVE-2014-0102',
        'CVE-2014-0203',
        'CVE-2014-0205',
        'CVE-2014-2889',
        'CVE-2014-3535',
        'CVE-2014-8369',
        'CVE-2014-8480',
        'CVE-2014-8481',
        'CVE-2014-9870',
        'CVE-2014-9903',
        'CVE-2015-2877',
        'CVE-2015-3214',
        'CVE-2015-3339',
        'CVE-2015-8324',
        'CVE-2015-8539',
        'CVE-2016-2550',
        'CVE-2016-3139',
        'CVE-2016-8660',
        'CVE-2016-9919',
        'CVE-2017-13080',
        'CVE-2017-13686',
        'CVE-2017-13693',
        'CVE-2017-13694',
        'CVE-2017-13715',
        'CVE-2017-2634',
        'CVE-2017-7979',
        'CVE-2018-10074',
        'CVE-2018-10901',
        'CVE-2018-1121',
        'CVE-2018-1128',
        'CVE-2018-1129',
        'CVE-2018-12928',
        'CVE-2018-12929',
        'CVE-2018-12930',
        'CVE-2018-12931',
        'CVE-2018-14641',
        'CVE-2018-17977',
        'CVE-2019-0146',
        'CVE-2019-12382',
        'CVE-2019-12456',
        'CVE-2019-15239',
        'CVE-2019-15290',
        'CVE-2019-15794',
        'CVE-2019-15902',
        'CVE-2019-16089',
        'CVE-2019-18680',
        'CVE-2019-19378',
        'CVE-2019-19449',
        'CVE-2019-19814',
        'CVE-2019-20794',
        'CVE-2019-3896',
        'CVE-2019-9457',
        'CVE-2020-0347',
        'CVE-2020-0435',
        'CVE-2020-0543',
        'CVE-2020-10708',
        'CVE-2020-11725',
        'CVE-2020-12362',
        'CVE-2020-14304',
        'CVE-2020-15802',
        'CVE-2020-16119',
        'CVE-2020-24502',
        'CVE-2020-24503',
        'CVE-2020-25220',
        'CVE-2020-26140',
        'CVE-2020-26142',
        'CVE-2020-26143',
        'CVE-2020-26555',
        'CVE-2020-26556',
        'CVE-2020-26557',
        'CVE-2020-26559',
        'CVE-2020-26560',
        'CVE-2020-27820',
        'CVE-2020-35501',
        'CVE-2020-3702',
        'CVE-2021-0399',
        'CVE-2021-0606',
        'CVE-2021-26932',
        'CVE-2021-26934',
        'CVE-2021-3542',
        'CVE-2021-3635',
        'CVE-2021-3640',
        'CVE-2021-3669',
        'CVE-2021-3715',
        'CVE-2021-3753',
        'CVE-2021-3759',
        'CVE-2021-40490',
    ]
)
@pytest.mark.brokenmetadata(
    ('cve'),
    [
        'CVE-2015-3332',
        'CVE-2015-8019',
    ]
)
def test_git_on_branch(githound, branch, meta_cve):
    assert not githound.check_cve(meta_cve), meta_cve + ' on ' + branch
